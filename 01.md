# Cheat Sheet

Install elastic serach and kibana from: https://www.elastic.co/downloads/kibana
On windows: 
```
$env:JAVA_HOME="C:\Program Files\Java\jdk1.8.0_172"
```
Run elastic search (http://localhost:9200/) and kibana (http://localhost:5601)

Example: 

```
curl -XPUT http://localhost:9200/catalog/product/1 -d '{ "sku": "SP000001", "title": "Elasticsearch for Hadoop", "description": "Elasticsearch for Hadoop", "author": "Vishal Shukla", "ISBN": "1785288997", "price": 26.99}'

PUT /catalog/product/1
{
    "sku": "SP000001",
    "title": "Elasticsearch for Hadoop",
    "description": "Elasticsearch for Hadoop",
    "author": "Vishal Shukla",
    "ISBN": "1785288997",
    "price": 26.99
}

```

Dynamic mapping ``` GET /catalog/_mapping/product ```

# Index API
Indexing with an ID: 

```
PUT /catalog/product/1
{
    "sku": "SP000001",
    "title": "Elasticsearch for Hadoop",
    "description": "Elasticsearch for Hadoop",
    "author": "Vishal Shukla",
    "ISBN": "1785288997",
    "price": 26.99
}
```

Without an ID: 

```
POST /catalog/product
{
    "sku": "SP000003",
    "title": "Mastering Elasticsearch",
    "description": "Mastering Elasticsearch",
    "author": "Bharvi Dixit",
    "price": 54.99
}
```
Id is a hash string: 
```
{
  "_index": "catalog",
  "_type": "product",
  "_id": "AVrASKqgaBGmnAMj1SBe",
  "_version": 1,
  "result": "created",
  "_shards": {
    "total": 2,
    "successful": 1,
    "failed": 0
  },
  "created": true
}
```

# Get API

```
GET /<index>/<type>/<id>
GET /catalog/product/AVrASKqgaBGmnAMj1SBe
```

# Update API
```
POST <index>/<type>/<id>/_update
POST /catalog/product/1/_update
{
  "doc": {
    "price": "28.99"
  }
}
```

Upsert: 

```
POST /catalog/product/3/_update
{
  "doc": {
    "author": "Albert Paro",
    "title": "Elasticsearch 5.0 Cookbook",
    "description": "Elasticsearch 5.0 Cookbook Third Edition",
    "price": "54.99"
  },
  "doc_as_upsert": true
}
```

Before that you might have to run this: 

```
PUT  catalog/_settings
{
  "index": {
    "blocks": {
      "read_only_allow_delete": false
    }
  }
}
```
